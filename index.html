<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="Project Title">
  <meta name="author" content="Ricardo Garcia">
  <title>Catching Transparent Phish: Analyzing and Detecting MITM Phishing Toolkits</title>

  <link href="css/bootstrap.min.css" rel="stylesheet">
  <link href="css/style.css" rel="stylesheet">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="script/scroll.js"></script>
</head>
<body>
  <nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark">
    <a class="navbar-brand" href="index.html">Catching Transparent Phish</a>

    <div class="navbar-collapse collapse w-100 order-3 dual-collapse2">
      <ul class="navbar-nav ml-auto">
        <li class="nav-item">
          <a class="nav-link active" href="#abstract">Abstract</a>
        </li>
        <li class="nav-item">
          <a class="nav-link active" href="#section1">Overview</a>
        </li>
        <li class="nav-item">
          <a class="nav-link active" href="#contributors">Contributors</a>
        </li>
        <li class="nav-item">
          <a class="nav-link active" href="#links">Links</a>
        </li>
      </ul>
    </div>
  </nav>

  <main role="main">

    <div class="jumbotron">
      <div class="container">
        <div class=="row">
          <div class="col-sm">
            <h1 class="display-5 text-center">Catching Transparent Phish: Analyzing and Detecting MITM Phishing Toolkits<br></h1>
	    <br>
            <h5 class="display-5 text-center">
		<a href="">ACM SIGSAC Conference on Computer and Communications Security (CCS) 2021</a>
	    </h5>
          </div>
        </div>
        <br>
        <br>
	<!--
        <div class=="row">
          <div class="col-md">
            <div class="embed-responsive embed-responsive-16by9">
                <iframe class="embed-responsive-item" src="video/dummy_video.mp4"></iframe>
            </div>
          </div>
        </div>
	-->
      </div>
    </div>

    <div class="container section" id="abstract">
      <div class="row">
        <div class="col-sm">
          <h2 class="text-center">Abstract</h2>
          <hr>
          <p>For over a decade, phishing toolkits have been helping attackers automate and streamline their phishing campaigns. Man-in-the- Middle (MITM) phishing toolkits are the latest evolution in this space, where toolkits act as malicious reverse proxy servers of online services, mirroring live content to users while extracting credentials and session cookies in transit. These tools further reduce the work required by attackers, automate the harvesting of 2FA-authenticated sessions, and substantially increase the believability of phishing web pages. </p>
<p>In this paper, we present the first analysis of MITM phishing toolkits used in the wild. By analyzing and experimenting with these toolkits, we identify intrinsic network-level properties that can be used to identify them. Based on these properties, we develop a machine learning classifier that identifies the presence of such toolkits in online communications with 99.9% accuracy. </p> 
<p>We conduct a large-scale longitudinal study of MITM phishing toolkits by creating a data-collection framework that monitors and crawls suspicious URLs from public sources. Using this infrastructure, we capture data on 1,220 MITM phishing websites over the course of a year. We discover that MITM phishing toolkits occupy a blind spot in phishing blocklists, with only 43.7% of domains and 18.9% of IP addresses associated with MITM phishing toolkits present on blocklists, leaving unsuspecting users vulnerable to these attacks. Our results show that our detection scheme is resilient to the cloaking mechanisms incorporated by these tools, and is able to detect previously hidden phishing content. Finally, we propose methods that online services can utilize to fingerprint requests originating from these toolkits and stop phishing attempts as they occur.</p>
          <br>
          <br>
        </div>
      </div>
      <div class="row">
        <div class="col-sm">
	<div style="text-align: center">
          <img  src="img/mitmToolkitOverview.png" alt="Method Overview" height="340" width="auto">
	</div>
        </div>
      </div>
    </div>

    <div class="container section" id="section1">
      <div class="row">
        <div class="col-sm">
          <h2 class="text-center">What are MITM Phishing Toolkits?</h2>
          <hr>
          <p> MITM phishing toolkits are the state of the art in phishing attacks today. They function as reverse proxy servers, brokering communication between 
	      victim users and target web servers, all while harvesting sensitive information from the network data in transit. This design lends itself to increased believability of the phishing attack since the returned web pages are live on the target web server and thus indistinguishable to the victim. Additionally, unlike traditional phishing attacks, where believable behavior ceases after the desired information (e.g. credentials and credit card numbers) is acquired, these toolkits persist the victim’s browsing session after authentication is complete. This means users can browse the target website with their authenticated session through the phishing server. This puts the victim at ease and increases the timespan that the session cookie is valid, allowing the attacker more time to conduct their desired malicious actions. In this paper, we study three popular MITM phishing toolkits: <a href="https://github.com/kgretzky/evilginx2"> Evilginx</a>, <a href="https://github.com/muraenateam/muraena">Muraena</a>, and <a href="https://github.com/drk1wi/Modlishka">Modlishka</a>.</p>

	<div style="padding:36.25% 0 0 0;position:relative;">
		<iframe src="https://player.vimeo.com/video/544716265?h=5fe641c120&amp;badge=0&amp;autopause=0&amp;player_id=0&amp;app_id=58479" frameborder="0" allow="autoplay; fullscreen; picture-in-picture" allowfullscreen style="position:absolute;top:0;left:0;width:100%;height:100%;padding-top:2%" title="Evilginx Demo"></iframe>
	</div>
	<script src="https://player.vimeo.com/api/player.js"></script>

        </div>
      </div>
    </div>

    <div class="container section" id="section2">
      <div class="row">
        <div class="col-sm">
          <h2 class="text-center">How we Detect Them</h2>
          <hr>
          <p> The network architecture of MITM phishing toolkits signifigantly decreases the effectiveness of content-based phishing detection techniques. Additionally, as attackers control all application layer content, JavaScript-based defenses can be easily filtered by attackers. Therefore, we aim to fingerprint the web server rather than the web content. To achieve this, we focus on two categories of network-level features to distinguish MITM phishing toolkits from benign web servers: network timing features, and TLS fingerprinting features. Using these two feature groups, we can reliably detect the presence of MITM phishing toolkits in online communications. Additionally, as these features are fundamental to the architecture of MITM phishing toolkits, attackers can not trivially bypass our fingerprinting. For more in-depth information on our fingerprinting techniques, please see our <a href="">paper</a>.</p>
	  <p>Utilizing the previously described features, we develop a tool to automatically collect data on, and classify MITM phishing toolkits on the web. We call this tool PHOCA, after the Latin word for “seal.” Seals are aquatic mammals known to hunt hidden prey using vibrations generated by their breathing. Similarly to this hunting technique, PHOCA can detect previously-hidden MITM phishing toolkits using features inherent to their nature, as opposed to visual-cues.
When provided either a URL or domain-name, PHOCA probes the desired web server to collect the previously mentioned network-level features. PHOCA then uses our trained classifier to determine if the web server is a MITM phishing toolkit. Using this tool, new training data can be easily generated for any future MITM phishing toolkit iteration. Additionally, PHOCA can be integrated into existing anti-phishing workflows to fingerprint active threats.
</p>


	<div style="padding:36.25% 0 0 0;position:relative;">
		<iframe src="https://player.vimeo.com/video/544725046?h=2d68f08e0e&amp;badge=0&amp;autopause=0&amp;player_id=0&amp;app_id=58479" frameborder="0" allow="autoplay; fullscreen; picture-in-picture" allowfullscreen style="position:absolute;top:0;left:0;width:100%;height:100%;padding-top:2%" title="PHOCA Demo"></iframe>
	</div>

        </div>
      </div>
    </div>

    <div class="container section" id="contributors">
      <div class="row">
        <div class="col-sm">
          <h2 class="text-center">Project Contributors</h2>
          <hr>
        </div>
      </div>
      <br>
      <br>

      <div class="row text-center">
        <!--<div class="col-lg-4 justify-content-center">-->
        <div class="col-lg-2"></div>
        <div class="col-lg-4">
          <a href="#" target="_blank">
              <img class="rounded-circle" src="img/brian.jpg" alt="Contributor" width="180" height="180">
          </a>
          <h4><a href="https://briankondracki.com" target="_blank">Brian Kondracki</a></h4>
        </div>
        <div class="col-lg-4">
          <a href="#">
              <img class="rounded-circle" src="img/babak.jpg" alt="Contributor" width="180" height="180">
          </a>
          <h4><a href="https://www.silverf0x00.com">Babak Amin Azad</a></h4>
        </div>
      </div>

      <div class="row text-center">
        <div class="col-lg-2"></div>
        <div class="col-lg-4">
          <a href="#" target="_blank">
              <img class="rounded-circle" src="img/alex.jpg" alt="Contributor" width="180" height="180">
          </a>
          <h4><a href="https://www.cyberphilosopher.org" target="_blank">Oleksii Starov</a></h4>
        </div>
        <div class="col-lg-4">
          <a href="#" target="_blank">
              <img class="rounded-circle" src="img/nick.jpg" alt="Contributor" width="180" height="180">
          </a>
          <h4><a href="https://securitee.org" target="_blank">Nick Nikiforakis</a></h4>
        </div>
	<!--
        <div class="col-lg-4">
          <a href="#" target="_blank">
            <img class="rounded-circle" src="img/contributor_dummy.png" alt="Contributor" width="180" height="180">
          </a>
          <h4><a href="#" target="_blank">Contributor 5</a></h4>
        </div>
	-->
        <div class="col-lg-2"></div>
      </div>


    </div>
    <div class="container section" id="links">
      <div class="row">
        <div class="col-sm">
          <h2 class="text-center">Links</h2>
          <hr>
        </div>
      </div>
      <br>
      <br>
      <div class="row">
        <div class="col-sm text-center">
          <svg width="3em" height="3em" viewBox="0 0 16 16" class="bi bi-code-slash" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
            <path fill-rule="evenodd" d="M4.854 4.146a.5.5 0 0 1 0 .708L1.707 8l3.147 3.146a.5.5 0 0 1-.708.708l-3.5-3.5a.5.5 0 0 1 0-.708l3.5-3.5a.5.5 0 0 1 .708 0zm6.292 0a.5.5 0 0 0 0 .708L14.293 8l-3.147 3.146a.5.5 0 0 0 .708.708l3.5-3.5a.5.5 0 0 0 0-.708l-3.5-3.5a.5.5 0 0 0-.708 0zm-.999-3.124a.5.5 0 0 1 .33.625l-4 13a.5.5 0 0 1-.955-.294l4-13a.5.5 0 0 1 .625-.33z"/>
          </svg>
          <h4>Code & Data</h4>
          <div class="col-sm text-center" style="padding-bottom:5px">
		<a href="https://github.com/catching-transparent-phish/phoca" role="button" class="btn btn-dark">
              <img src="img/GitHub-Mark-Light-32px.png" width="20px"> PHOCA
            </a>
          </div>
          <div class="col-sm text-center" style="padding-bottom:5px">
		<a href="https://github.com/catching-transparent-phish/catching-transparent-phish.github.io/blob/main/dataset.zip" role="button" class="btn btn-dark">
              <img src="img/GitHub-Mark-Light-32px.png" width="20px"> Dataset
            </a>
          </div>
          <div class="col-sm text-center">
		<a href="" role="button" class="btn btn-dark">
              <img src="img/GitHub-Mark-Light-32px.png" width="20px"> Data Collection (Coming Soon)
            </a>
          </div>
        </div>
	

        <div class="col-sm text-center">
          <svg width="3em" height="3em" viewBox="0 0 16 16" class="bi bi-file-earmark-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
            <path fill-rule="evenodd" d="M4 1a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V5.707A1 1 0 0 0 13.707 5L10 1.293A1 1 0 0 0 9.293 1H4zm5 1v3a1 1 0 0 0 1 1h3L9 2z"/>
          </svg>
          <h4>Paper</h4>
          <a href="catching_transparent_phish.pdf" role="button" class="btn btn-dark">
            <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-files" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
              <path fill-rule="evenodd" d="M3 2h8a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2zm0 1a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V4a1 1 0 0 0-1-1H3z"/>
              <path d="M5 0h8a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2v-1a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H5a1 1 0 0 0-1 1H3a2 2 0 0 1 2-2z"/>
            </svg> PDF
          </a>
        </div>
      </div>
      <div class="container">
        <div class="row">
          <div class="col-sm">
            <h2 class="text-center">Citation</h2>
            <hr>
          </div>
        </div>
        <br>
        <div class="row">
          <div class="col-sm">
            <p>To cite our work, please use:</p>
            <pre class="citation">
              <code>
	@article{kondracki2021catching,
	    title={Catching Transparent Phish: Analyzing and Detecting MITM Phishing Toolkits},
	    author={Kondracki, Brian and Azad, Babak Amin and Starov, Oleksii and Nikiforakis, Nick},
	    year={2021}
	}
		</code>
              </pre>

            </div>
          </div>
        </div>
      </div>

      <div id="footer">
        <div class="container">
          <div class="row align-items-center h-100">
            <div class="col-md-4 text-center">
              <a href="#" target="_blank">
                <img src="img/pragsec.png" alt="Pragsec Lab" width="240">
              </a>
            </div>
            <div class="col-md-4 text-center">
              <a href="#" target="_blank">
                <img src="img/sbu.png" alt="Organization 2" width="240">
              </a>
            </div>
            <div class="col-md-4 text-center align-middle">
                <h5>&copy; Copyright PragSec Lab 2021</h5>
                Website Design: <a href="https://github.com/rjgpinel/dark-academic-website" target="_blank">dark-academic-website</a>
            </div>
          </div>
        </div>
      </div>
    </main>
</body>
</html>
